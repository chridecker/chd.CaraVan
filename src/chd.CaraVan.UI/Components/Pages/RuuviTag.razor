@page "/ruuvitag/{Id:int}"
@using chd.CaraVan.UI.Components.Pages.Cards
@inject IOptionsMonitor<DeviceSettings> options
@inject IRuuviTagDataService dataService
<MudText Typo="Typo.h3">@device.Name</MudText>

@foreach (var devData in dataLst)
{
    <DataCard Data="devData" Min="@this.minMax(devData.Type).Min" Max="@this.minMax(devData.Type).Max" />
}

@code {
    [Parameter] public int Id { get; set; }

    DeviceDto device => options.CurrentValue.RuuviTags.FirstOrDefault(x => x.Id == this.Id);

    List<RuuviTagDeviceData> dataLst = new();

    private (decimal? Min, decimal? Max) minMax(EDataType type) => (0, 0);

    protected override async Task OnInitializedAsync()
    {
        var data = await dataService.GetData(this.Id);
        if (data is not null)
        {
            this.dataLst.Add(data);
        }
        await base.OnInitializedAsync();
    }

}
